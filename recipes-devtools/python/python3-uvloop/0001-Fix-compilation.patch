From 6660addf2207c58db4a5e8367aeb5b0b773bfd8b Mon Sep 17 00:00:00 2001
From: Tom Geelen <t.f.g.geelen@gmail.com>
Date: Tue, 13 Jan 2026 00:42:59 +0100
Subject: [PATCH] Fix compilation

Signed-off-by: Tom Geelen <t.f.g.geelen@gmail.com>
Upstream-Status: Inappropriate [oe-specific]
---
 pyproject.toml | 2 +-
 setup.py       | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/pyproject.toml b/pyproject.toml
index a8b0f32..cb8a71d 100644
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -58,7 +58,7 @@ docs = [
 requires = [
     "setuptools>=60",
     "wheel",
-    "Cython~=3.1",
+    "Cython>=3.1",
 ]
 build-backend = "setuptools.build_meta"
 
diff --git a/setup.py b/setup.py
index 32d94ae..4ec8033 100644
--- a/setup.py
+++ b/setup.py
@@ -83,7 +83,7 @@ class uvloop_build_ext(build_ext):
 
     def initialize_options(self):
         super().initialize_options()
-        self.use_system_libuv = False
+        self.use_system_libuv = os.environ.get("USE_SYSTEM_LIBUV") == "1"
         self.cython_always = False
         self.cython_annotate = None
         self.cython_directives = None
